extends ../../layout/default.pug
include ../../mixins/breadcrumbs.pug
include ../../mixins/alert.pug

block main
    +alert(messages)
    div(class="breadcrumb-nav")
        div(class="container-xl")
            +breadcrumb("Gi·ªè h√†ng", [
                { name: `Home`, href: `/` },
                { name: `Gi·ªè H√†ng`, href: `/cart` },
            ])
    if ((!user || !user.listItemCart || user.listItemCart.length < 1) && listItemCart.length < 1)
        main(class="empty-cart")
            div(class="container")
                p(class="empty-cart__text")
                    span(class="empty-cart__text-icon")
                        i(class="fa-solid fa-tag")
                        | Freeship v·ªõi ƒë∆°n h√†ng tr√™n 5.000.000ƒë. Mua s·∫Øm ngay n√†o!!!
                div(class="empty-cart__content")
                    span(class="empty-cart__icon-1")
                        i(class="fa-solid fa-cart-shopping")
                        span(class="empty-cart__icon-2")
                            i(class="fa-solid fa-circle-xmark")
                    h2(class="empty-cart__title") ‚ÄúH·ªïng‚Äù c√≥ g√¨ trong gi·ªè h·∫øt
                    p(class="empty-cart__desc") V·ªÅ trang c·ª≠a h√†ng ƒë·ªÉ ch·ªçn mua s·∫£n ph·∫©m b·∫°n nh√©!!
                    a(class="primary-btn empty-cart__btn" href="/") Mua s·∫Øm ngay
    else 
        main(class="shopping-cart")
            div(class="container-xl")
                div(class="shopping-cart__wrapper")
                    h1(class="shopping-cart__title") Gi·ªè h√†ng
                    div(class="row")
                        div(class="left-box col-12 col-lg-8")
                            div(class="shopping-cart__process-wrapper")
                                div(class="shopping-cart__process")
                                span 100%
                            div(class="shopping-cart__voucher")
                                p(class="shopping-cart__voucher-text")
                                    span(class="shopping-cart__voucher-icon")
                                        i(class="fa-solid fa-tag")
                                    | EGAFREESHIP
                            small Ch√∫c m·ª´ng! ƒê∆°n h√†ng c·ªßa b·∫°n ƒë√£ ƒë·ªß ƒëi·ªÅu ki·ªán ƒë∆∞·ª£c Freeship üéâ
                            div(class="order-list")
                                each item in listItemCart
                                    - quantity = item.quantity || 1;
                                    - item = item.product;
                                    div(class="order-item")
                                        div(class="order-item__content")
                                            a(href=`/cart/delete/${item._id}`)
                                                span(class="order-item__icon")
                                                    i(class="fa-solid fa-xmark")
                                            a(href=`/product/detail/${item.slug}`)
                                                img(class="order-item__img" src=item.thumbnails[0] || "/uploads/default-image.jpg" alt=item.name)
                                            div(class="order-item__info")
                                                a(class="order-item__name" href=`/product/detail/${item.slug}`) #{item.name}
                                        div(class="order-item__content order-item__content--right")
                                            p(class="order-item__price" , data-price=item.price) #{item.price.toLocaleString('vi-VN')}ƒë
                                            div(class="quantity-control")
                                                button(class="quantity-control__btn quantity-control__btn--decrease")
                                                    span
                                                        i(class="fa-solid fa-minus")
                                                input(class="quantity-control__input" type="number" value=quantity name="quantity-item" min=1 max=item.inventory data-id=item._id)
                                                button(class="quantity-control__btn quantity-control__btn--increase")
                                                    span
                                                        i(class="fa-solid fa-plus")
                                label(class="order-item__label" for="note") Ghi ch√∫ ƒë∆°n h√†ng
                                textarea(name="note" class="order-item__note" id="note")
                         
                        div(class="right-box col-12 col-lg-4")
                            h4(class="right-box__title") H√ìA ƒê∆†N
                            table(class="bill")
                                tr
                                    td T·∫°m t√≠nh
                                    td(class="bill__price", id="bill__price", data-price=totalPriceAndDiscount.totalPrice) #{totalPriceAndDiscount.totalPrice.toLocaleString('vi-VN')}ƒë
                                tr(id="bill-discount", style="display: none")
                                tr
                                    td Ph√≠ v·∫≠n chuy·ªÉn
                                    td(class="bill__discount") Mi·ªÖn ph√≠
                            hr
                            div(class="discount")
                                div(class="discount__text")
                                    span(class="discount__icon")
                                        i(class="fa-solid fa-tag")
                                    | M√£ gi·∫£m gi√°
                                div(class="discount__code")
                                    button(class="btn-discount",
                                        type="button",
                                        data-bs-toggle="offcanvas",
                                        data-bs-target="#offcanvasExample",
                                        aria-controls="offcanvasExample"
                                    )
                                        | Ch·ªçn m√£ gi·∫£m gi√°
                                        span
                                            i(class="fa-solid.fa-chevron-right")
                            div(class="product__discount" id="product__discount")

                            hr
                            div(class="total")
                                p(class="total__text") T·ªïng Thanh to√°n
                                div(class="total__detail")
                                    p(class="total__price", id="total__price") #{(totalPriceAndDiscount.totalPrice).toLocaleString('vi-VN')}ƒë
                                    small (ƒê√£ bao g·ªìm VAT n·∫øu c√≥)
                            form(action="/checkout/cart", method="post") 
                                input(type="hidden", name="vc", value="" id="vc-input")
                                button(class="primary-btn pay-btn" type="submit") thanh to√°n
    include ../../partials/list_voucher.pug